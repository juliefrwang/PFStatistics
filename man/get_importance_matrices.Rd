% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/PFselect.R
\name{get_importance_matrices}
\alias{get_importance_matrices}
\title{Get Importance Matrices}
\usage{
get_importance_matrices(
  genetic_variants,
  genetic_variants_knockoff,
  additional_covariates,
  Z,
  y,
  n_folds = 10,
  standardize = TRUE,
  FDR_rate = 0.1,
  model = "Lasso",
  metric = "mse"
)
}
\arguments{
\item{genetic_variants}{Matrix of genetic variants (n_samples x n_variants).}

\item{genetic_variants_knockoff}{Matrix of knockoff genetic variants
(n_samples x n_variants).}

\item{additional_covariates}{Matrix of additional covariates (n_samples x n_covariates),
or NULL if not provided.}

\item{Z}{Vector or matrix representing heterogeneity variable(s) (e.g., EUR or PCs)
(n_samples x n_Z_variables). Cannot be NULL.}

\item{y}{Outcome vector (length n_samples).}

\item{n_folds}{Number of folds for cross-validation (default: 10).}

\item{standardize}{Logical flag for x variable standardization prior to fitting
the model sequence. The coefficients are always returned on the original scale
(default: TRUE).}

\item{FDR_rate}{False Discovery Rate threshold (default: 0.1).}

\item{model}{Model type: "Lasso" or "Grplasso" (default: "Lasso").}

\item{metric}{Metric for Lasso model: "mse" for mean squared error or "r" for correlation
(default: "mse"). Only used when model="Lasso".}
}
\value{
A list containing:
\item{coefs}{Extracted model coefficients.}
\item{scaled_selection_matrix}{Scaled selection matrix (n_samples x n_variants).}
\item{selection_matrix}{Binary selection matrix (n_samples x n_variants).}
\item{W_statistic_matrix}{W statistic matrix (n_samples x n_variants).}
\item{q_values}{Matrix of q-values (n_samples x n_variants).}
}
\description{
Main function that generates scaled selection, selection, and W statistic matrices
using genetic variants and knockoff variants data with Lasso or Group Lasso models.
}
